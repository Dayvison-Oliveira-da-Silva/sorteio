<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shelf Dental Med</title>
  <link rel="icon" href="logo.png" type="image/png">
  <style>
    body {
      margin: 0;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      flex-direction: column;
    }

    .logo-container {
      display: flex;
      align-items: center;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInMoveUp 1s ease-out 0.5s forwards;
      z-index: 2;
      position: relative;
    }

    @keyframes fadeInMoveUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .logo-symbol {
      width: 100px;
      animation: symbolIn 1.6s ease-in-out 0.5s forwards;
      opacity: 0;
    }

    @keyframes symbolIn {
      0% {
        opacity: 0;
        transform: scale(0.5) rotate(-45deg);
        filter: grayscale(100%);
      }
      50% {
        filter: grayscale(0%);
      }
      100% {
        opacity: 1;
        transform: scale(1) rotate(0);
      }
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      margin-left: 20px;
      opacity: 0;
      animation: textIn 1.2s ease-out 1.8s forwards;
    }

    .logo-text h1 {
      margin: 0;
      font-size: 32px;
      color: #2b2b2b;
    }

    .logo-text span {
      font-size: 18px;
      color: #555;
      letter-spacing: 1px;
    }

    @keyframes textIn {
      0% {
        opacity: 0;
        transform: translateX(40px);
      }
      100% {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .shine {
      position: absolute;
      top: 0;
      left: -75%;
      width: 50%;
      height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.6), transparent);
      transform: skewX(-20deg);
      animation: shineEffect 2s ease-in-out 2.6s forwards;
      pointer-events: none;
    }

    @keyframes shineEffect {
      to {
        left: 125%;
      }
    }

    .typed-container {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: 40px;
      opacity: 0;
      animation: fadeInForm 0.6s ease-out forwards;
      animation-delay: 1s;
    }

    @keyframes fadeInForm {
      to {
        opacity: 1;
      }
    }

    .typed-text {
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      border-right: 3px solid #00aa88;
      width: 0;
      animation: typing 1.8s steps(35, end) 2s forwards, blink 0.75s step-end infinite;
    }

    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blink {
      50% { border-color: transparent; }
    }

    .input-name,
    .input-cpf,
    .input-endereco {
      display: none;
      margin-top: 25px;
      opacity: 0;
      transform: translateY(20px);
      animation: inputFadeIn 0.6s ease-out forwards;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      max-width: 95vw;
    }

    @keyframes inputFadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    input {
      padding: 12px 16px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 30px;
      width: 80%;
      outline: none;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    input:focus {
      border-color: #00aa88;
      box-shadow: 0 0 0 3px rgba(0,170,136,0.2);
    }

    button {
      background-color: #00aa88;
      border: none;
      padding: 12px 14px;
      border-radius: 50%;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    button:hover {
      background-color: #008870;
      transform: scale(1.1);
    }

    button svg {
      fill: white;
      width: 20px;
      height: 20px;
    }

    @media (max-width: 768px) {
      .typed-text { font-size: 100%; max-width: 90vw; }
    }

    @media (min-width: 769px) {
      .typed-text { font-size: 24px; }
    }
  </style>
</head>
<body>
  <div class="logo-container" id="logoContainer">
    <img src="logo.png" alt="Shelf Logo" class="logo-symbol" />
    <div class="logo-text">
      <h1>SHELF</h1>
      <span>DENTAL MED</span>   
    </div>
    <div class="shine"></div>
  </div>

  <div class="typed-container" id="typedContainer">
    <div class="typed-text" id="typedText">Ei! Podemos saber seu nome?</div>

    <div class="input-name" id="inputName">
      <input type="text" placeholder="Digite seu nome aqui..." id="nameInput">
      <button id="nameButton">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
      </button>
    </div>

    <div class="input-cpf" id="inputCpf">
      <input type="text" placeholder="Digite seu CPF..." id="cpfInput" maxlength="14">
      <button id="cpfButton">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
      </button>
    </div>

    <div class="input-endereco" id="inputEndereco">
      <input type="text" placeholder="CEP..." id="cepInput" maxlength="9">
      <input type="text" placeholder="Rua..." id="ruaInput">
      <input type="text" placeholder="Número..." id="numeroInput">
      <input type="text" placeholder="Bairro..." id="bairroInput">
      <input type="text" placeholder="telefone..." id="telefoneInput">
      <button id="enderecoButton">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
      </button>
    </div>
  </div>

  <script>
  setTimeout(() => document.querySelector('.shine').style.display = 'block', 2600);
  setTimeout(() => {
    document.getElementById('logoContainer').style.display = 'none';
    document.getElementById('typedContainer').style.display = 'flex';
  }, 3800);
  setTimeout(() => {
    document.getElementById('inputName').style.display = 'flex';
  }, 3900);

  function validarCPF(cpf) {
    cpf = cpf.replace(/[^\d]+/g,'');
    if(cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
    let soma = 0, resto;
    for (let i = 1; i <= 9; i++) soma += parseInt(cpf[i-1]) * (11 - i);
    resto = (soma * 10) % 11;
    if (resto === 10 || resto === 11) resto = 0;
    if (resto !== parseInt(cpf[9])) return false;
    soma = 0;
    for (let i = 1; i <= 10; i++) soma += parseInt(cpf[i-1]) * (12 - i);
    resto = (soma * 10) % 11;
    if (resto === 10 || resto === 11) resto = 0;
    return resto === parseInt(cpf[10]);
  }

  let cpfValido = '';

  document.getElementById('nameButton').addEventListener('click', () => {
    const name = document.getElementById('nameInput').value.trim();
    if (name.length > 0) {
      document.getElementById('inputName').style.display = 'none';
      document.getElementById('typedText').innerText = "Agora, informe seu CPF:";
      setTimeout(() => {
        document.getElementById('inputCpf').style.display = 'flex';
      }, 600);
    }
  });

  document.getElementById('cpfButton').addEventListener('click', async () => {
    const cpf = document.getElementById('cpfInput').value.trim();
    if (!validarCPF(cpf)) {
      alert("CPF inválido.");
      return;
    }

    const cpfFormatado = cpf.replace(/[^\d]/g, '');
    try {
      const response = await fetch('https://sorteio-shelf-default-rtdb.firebaseio.com/cadastros.json');
      const data = await response.json();
      const jaCadastrado = Object.values(data || {}).some(entry => entry.cpf === cpfFormatado);
      if (jaCadastrado) {
        alert("CPF já cadastrado.");
      } else {
        cpfValido = cpfFormatado;
        document.getElementById('inputCpf').style.display = 'none';
        document.getElementById('typedText').innerText = "Precisamos do seu endereço e contato agora:";
        setTimeout(() => {
          document.getElementById('inputEndereco').style.display = 'flex';
        }, 600);
      }
    } catch (err) {
      console.error("Erro ao verificar CPF:", err);
      alert("Erro ao verificar CPF.");
    }
  });

  document.getElementById('enderecoButton').addEventListener('click', async () => {
    const nome = document.getElementById('nameInput').value.trim();
    const cep = document.getElementById('cepInput').value.trim();
    const rua = document.getElementById('ruaInput').value.trim();
    const numero = document.getElementById('numeroInput').value.trim();
    const bairro = document.getElementById('bairroInput').value.trim();
    const telefone = document.getElementById('telefoneInput').value.trim();

    if (!nome || !cpfValido || !cep || !rua || !numero || !bairro || !telefone) {
      alert("Por favor, preencha todos os campos.");
      return;
    }

    try {
      await fetch('https://sorteio-shelf-default-rtdb.firebaseio.com/cadastros.json', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          nome: nome,
          cpf: cpfValido,
          endereco: {
            cep: cep,
            rua: rua,
            numero: numero,
            bairro: bairro,
            telefone: telefone
          }
        })
      });

      alert("Cadastro concluído com sucesso!");
      document.getElementById('typedText').innerText = "Obrigado!";
      document.getElementById('inputEndereco').style.display = 'none';
    } catch (err) {
      console.error("Erro ao salvar cadastro:", err);
      alert("Erro ao salvar cadastro.");
    }
    setTimeout(() => {
        document.getElementById('typedText').innerText = "";
    }, 2000);
    setTimeout(() => {
        document.getElementById('typedText').innerText = "você já segue a gente no Instagram?";
    }, 2500);
    setTimeout(() => {
        document.getElementById('typedText').innerHTML = 
    'Se não, <a href="https://instagram.com/shelfdentalmed" target="_blank" style="color: #007bff; text-decoration: underline;">clica aqui e segue a gente</a><br>pra não perder o sorteio!';
}, 4500);
  });
</script>

</body>
</html>
